angular.module("MovnThereUI",["ui.bootstrap","ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","uiGmapgoogle-maps"]).run(["$rootScope","$location","$http","$window","AuthFactory","UserFactory","TypeAheadFactory",function(a,b,c,d,e,f){"use strict";a.$on("$routeChangeStart",function(){e.isAuthenticated()?(e.isAuthenticated()&&(c.defaults.headers.common.Authorization="Token token="+d.sessionStorage.getItem("movnThereUI.user")),f.fetch()):"/login"!==b.path()&&"/signup"!==b.path()&&b.path("/login")})}]),angular.module("MovnThereUI").constant("_",window._).constant("GglKey","AIzaSyDauT5fcf7PjOB7Kp3aM4xua9GBub1Q724").constant("ServerUrl","https://movn-there-api.herokuapp.com/"),angular.module("MovnThereUI").config(["$routeProvider",function(a){"use strict";a.when("/",{templateUrl:"views/home.html",controller:"HomeCtrl"}).when("/users",{templateUrl:"views/users.html",controller:"UserCtrl"}).when("/login",{templateUrl:"views/login.html",controller:"LoginCtrl"}).when("/signup",{templateUrl:"views/signup.html",controller:"SignupCtrl"}).when("/logout",{controller:"LogoutCtrl"}).when("/about",{templateUrl:"views/about.html"}).when("/contact",{templateUrl:"views/contact.html"}).otherwise({redirectTo:"/"})}]),angular.module("MovnThereUI").controller("NavbarController",["$scope","$location","AuthFactory",function(a,b,c){"use strict";a.isActive=function(a){return a===b.path()},a.logout=function(){c.logout().success(function(){b.path("/login")})},a.isLoggedIn=function(){return c.isAuthenticated()}}]),angular.module("MovnThereUI").controller("HomeCtrl",["$scope","uiGmapGoogleMapApi","TypeAheadFactory",function(a,b,c){"use strict";a.latitude=42.3584865,a.longitude=-71.060097,a.onSelect=function(b){a.latitude=b.location.lat,a.longitude=b.location.lng,a.city=b.formatted_address,a.marker.coords.latitude=b.location.lat,a.marker.coords.longitude=b.location.lng,a.map.control.refresh({latitude:a.latitude,longitude:a.longitude})},a.getLocation=function(a){return c.getLocation(a).then(function(a){var b=[];return angular.forEach(a.data.results,function(a){b.push({formatted_address:a.formatted_address,location:a.geometry.location})}),b})},a.map={center:{latitude:a.latitude,longitude:a.longitude},zoom:12,control:{}},a.marker={idKey:1,coords:{latitude:a.latitude,longitude:a.longitude},control:{}},a.getCitiesInRadius=function(){}}]),angular.module("MovnThereUI").controller("LoginCtrl",["$scope","$location","AuthFactory",function(a,b,c){"use strict";a.login=function(a){c.login(a).success(function(){b.path("/")})},a.goToSignup=function(){b.path("/signup")}}]),angular.module("MovnThereUI").controller("SignupCtrl",["$scope","$location","AuthFactory",function(a,b,c){"use strict";a.signup=function(a){c.signup(a).success(function(){b.path("/")})},a.goTologin=function(){b.path("/login")}}]),angular.module("MovnThereUI").controller("LogoutCtrl",["$scope","$location","AuthFactory",function(a,b,c){"use strict";a.logout=function(a){c.login(a).success(function(){b.path("/")})}}]),angular.module("MovnThereUI").controller("UserCtrl",["$scope","UserFactory",function(a,b){"use strict";a.users=b.users}]),angular.module("MovnThereUI").factory("UserFactory",["$http","ServerUrl",function(a,b){"use strict";var c=[],d=function(){a.get(b+"users.json").success(function(a){angular.copy(a,c)})};return{users:c,fetch:d}}]),angular.module("MovnThereUI").factory("AuthFactory",["$http","$window","ServerUrl",function(a,b,c){"use strict";var d=function(d){return a.post(c+"login",d).success(function(c){b.sessionStorage.setItem("movnThereUI.user",c.token),a.defaults.headers.common.Authorization="Token token="+b.sessionStorage.getItem("movnThereUI.user")})},e=function(d){var e={user:d};return a.post(c+"signup",e).success(function(c){b.sessionStorage.setItem("movnThereUI.user",c.token),a.defaults.headers.common.Authorization="Token token="+b.sessionStorage.getItem("movnThereUI.user")})},f=function(){return a.post(c+"/logout").success(function(){b.sessionStorage.removeItem("movnThereUI.user")})},g=function(){return!!b.sessionStorage.getItem("movnThereUI.user")};return{login:d,signup:e,logout:f,isAuthenticated:g}}]),angular.module("MovnThereUI").factory("TypeAheadFactory",["$http","GglKey",function(a,b){"use strict";return{getLocation:function(c){return a.get("https://maps.googleapis.com/maps/api/geocode/json",{headers:{Accept:"application/json, text/plain, * / *",Authorization:void 0},params:{address:c,key:b,types:"(cities)",components:"country:US",sensor:!1}})}}}]);